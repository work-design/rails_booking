<table class="ui celled table">
  <thead>
    <tr>
      <th class="one wide"></th>
      <% @time_plan.xx.each do |index, name| %>
        <th class="two wide"><%= name %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @time_plan.time_items.each do |time_item| %>
      <tr>
        <td>
          <time data-format="HH:mm"><%= time_item.start_at.to_s(:rfc822) %></time>
          <span>~</span>
          <time data-format="HH:mm"><%= time_item.finish_at.to_s(:rfc822) %></time>
        </td>
        <% @time_plan.xx.each do |index, _| %>
        <td class="<%= active_assert(Array(@time_plan.repeat_days[index.to_s]).include?(time_item.id), expected: 'orange selectable', unexpected: 'blue selectable') %>">
          <%= link_to time_plan_path(@time_plan.plan_type, @time_plan.plan_id, @time_plan), method: :patch, data: { params: "index=#{index}&time_item_id=#{time_item.id}" }, remote: true do %>
            <div class="ui labels">
              <% @time_plan.plan_items.where(time_item_id: time_item.id, repeat_index: index).each do |plan_item| %>
              <span class="ui label"><%= link_to_if plan_item.plan_on, plan_item_plan_attenders_path(plan_item) %></span>
              <% end %>
            </div>
          <% end %>
        </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
